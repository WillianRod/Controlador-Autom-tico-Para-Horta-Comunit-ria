function showDisplay(e){if("image/png"===e.content_type){var t=$("#plot");t.show(),t.attr("src",e.data_url),$("#webplot").hide()}else"application/json"===e.content_type&&($("#plot").hide(),$.get(e.data_url,function(e){renderVega(e,"#webplot")}))}function renderVega(e,t){var i=new thingSpeakWebplot;e.resizable=!0,e.resizableButtonVisible=!1,i.loadLibraries(),i.setSpec(e,t),i.render(),i.resize()}function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null}function changeOrientation(){newHeight=window.innerHeight,newWidth=window.innerWidth,$("#plot").css({width:newWidth,height:newHeight})}$(document).ready(function(){if(""!==$("#error").val())$("#spinner").hide(),displayError($("#error").val());else{var e=$("#matlab_display_data_path").val(),t=getDimensions();$.get(e,{height:t[0],width:t[1]},function(e){$("#spinner").hide(),"error"in e&&null!==e.error?displayError(e.error):showDisplay(e)},"json")}});var displayError=function(e){$('<p class="flash alert alert-danger">'+e+"</p>").insertBefore("#spinner")},getDimensions=function(){paramHeight=getURLParameter("height"),paramWidth=getURLParameter("width");var e=document.createElement("div");e.className="scrollbar-measure",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth,i=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),"auto"===paramWidth&&"auto"===paramHeight||"auto"===paramWidth&&null===paramHeight||null===paramWidth&&"auto"===paramHeight?(height=window.innerHeight-i,width=window.innerWidth-t,$(window).resize(function(){delay(function(){changeOrientation()},100)})):"auto"===paramWidth?(height=$("#height").val(),width=window.innerWidth-t):"auto"===paramHeight?(height=window.innerHeight-i,width=$("#width").val()):(height=$("#height").val(),width=$("#width").val()),[height,width]},delay=function(){var e=0;return function(t,i){clearTimeout(e),e=setTimeout(t,i)}}();